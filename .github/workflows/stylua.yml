name: Stylua check

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the "master" branch
  push:
    branches: [ "rework-healmodes-and-max-HPS" ]
  pull_request:
    branches: [ "rework-healmodes-and-max-HPS" ]

jobs:
  integration:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3
    - name: stylua
      uses: JohnnyMorganz/stylua-action@v3
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        version: latest # NOTE: we recommend pinning to a specific version in case of formatting changes
        args: --check .
    - name: Setup luarocks
      uses: leafo/gh-actions-luarocks@v4

    - name: Setup tools
      shell: bash
      run: |
        sudo apt install -y curl unzip --no-install-recommends
        bash ./utils/install_stylua.sh
        luarocks install luacheck
        luarocks install vusted
 #   - name: Run tests
 #     shell: bash
 #     run: make integration

    - name: Run tests
 #    shell: bash
      run: Stylua
